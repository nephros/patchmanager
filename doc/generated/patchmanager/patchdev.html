<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<!-- patchdev.qdoc -->
  <title>Patch Developer Documentation | Patchmanager Documentation</title>
  <link rel="stylesheet" type="text/css" href="style/offline.css" />
</head>
<body>
<div class="header" id="qtdocheader">
  <div class="content">
  </div>
  <div class="breadcrumb">
    <ul>
      <!--  Breadcrumbs go here -->
<li>https://github.com/sailfishos-patches/patchmanager/wiki</li>
<li><a href="index.html">Patchmanager Documentation</a></li>
<li>Patch Developer Documentation</li>
    </ul>
  </div>
</div>
<div class="content">
<div class="sidebar">
<div class="toc">
<h3><a name="toc">Contents</a></h3>
<ul>
<li class="level1"><a href="#patch-installation">Patch Installation</a></li>
<li class="level2"><a href="#web-catalog">Web Catalog</a></li>
<li class="level2"><a href="#rpm-package">RPM package</a></li>
<li class="level2"><a href="#tar-package">TAR package</a></li>
<li class="level2"><a href="#manual-installation">manual installation</a></li>
<li class="level1"><a href="#patch-format">Patch format</a></li>
<li class="level2"><a href="#patch-folder-structure">Patch folder structure</a></li>
<li class="level2"><a href="#metadata">Metadata</a></li>
</ul>
</div>
<div class="sidebar-content" id="sidebar-content"></div></div>
<h1 class="title">Patch Developer Documentation</h1>
<span class="subtitle"></span>
<!-- $$$patchdev.html-description -->
<div class="descr"> <a name="details"></a>
<a name="patch-installation"></a>
<h2 id="patch-installation">Patch Installation</h2>
<p>There are three ways a Patch can end up on the system:</p>
<ul>
<li>Web Catalog</li>
<li>RPM package</li>
<li>TAR package</li>
<li>manual installation</li>
</ul>
<a name="web-catalog"></a>
<h3 >Web Catalog</h3>
<p>Installation via the Patchmanager Web Catalog is the most common and recommended way of installing a patch. This is done through the Patchmanager UI, by selecting <b>install</b> on the <a href="../qml-plugin/qml-webpatchpage.html">Patch Page</a>.</p>
<p>PM will download metadata and a tarball from the Web Catalog, extract the tarball into the patch storage location, and generate the necessary JSON file from the metadata.</p>
<a name="rpm-package"></a>
<h3 >RPM package</h3>
<p>Patches may be distributed as RPM files, which assure the placement of files according to the structure explained above. RPM also provides advanced features like dependencies and scriptlets which may be necessary for correct operation or installation of a Patch.</p>
<a name="tar-package"></a>
<h3 >TAR package</h3>
<p>Patch developers may sometimes distribute Patches in <code>tar</code> format. Usually they also contain the necessary files, but the contents of the tarball may differ, and recipients of them must assure the layout given above is set up correctly.</p>
<a name="manual-installation"></a>
<h3 >manual installation</h3>
<p>Patch developers or users may want to quickly place a Patch under PM's supervision without going through the hassle of packaging and installing. This can be done easily, as long as the formats given above are followed.</p>
<a name="patch-format"></a>
<h2 id="patch-format">Patch format</h2>
<a name="patch-folder-structure"></a>
<h3 >Patch folder structure</h3>
<p>All Patches managed by PM are installed under <code>/usr/share/patchmanager/patches/$NAME</code>, where <code>$NAME</code> is a directory having a unique name.</p>
<p>That directory must contain at least two files: a <code>JSON</code> file called <code>patch.json</code> containing metadata, and a <code>diff</code> file called <code>unified_diff.patch</code>.</p>
<p>For information about <code>patch.json</code> metadata, see <a href="patchmeta.html#metadata">metadata</a>, and <a href="https://github.com/sailfishos-patches/patchmanager/blob/master/README.md#the-json-metadata-file">README</a></p>
<p><code>unified_diff.patch</code> must be in unified diff format, and must apply against the filesystem root when using patch with the options <code>-d / -p 1 --no-backup-if-mismatch</code></p>
<p>It may optionally also contain:</p>
<ul>
<li>Qt translation (.qm) files</li>
<li>icon files in PNG format</li>
<li>a QML file called <code>main.qml</code> (whose root element is a Sailfish Silica <code>Page</code>).</li>
<li>other QML-compatible files which are referenced/loaded from <code>main.qml</code></li>
</ul>
<p><b>Note: </b>the directory <code>$NAME</code> is usually and by convention the same as the patch metadata field <code>name</code>, but that is not a requirement. <code>$NAME</code> should be reasonably unique though, to avoid name clashes with Patches from others.</p><a name="metadata"></a>
<h3 >Metadata</h3>
<p>See <a href="patchmeta.html">Patch Metadata</a></p>
</div>
<!-- @@@patchdev.html -->
<div align='center'><hr/> <p><small>Patchmanager Documentation
Copyright (c) 2023 Patchmanager for SailfishOS contributors.
This document may be used under the terms of the  <a href='https://spdx.org/licenses/CC-BY-SA-4.0.html'> Creative Commons Attribution Share Alike 4.0 International</a>  License.</small></p> <p/></div></body>
</html>
